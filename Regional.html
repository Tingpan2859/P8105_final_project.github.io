<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Regional Analyze</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Report.html">About</a>
</li>
<li>
  <a href="Regional.html">Regional Analyze</a>
</li>
<li>
  <a href="Stars.html">Rating Analyze</a>
</li>
<li>
  <a href="Model-building.html">Model Building</a>
</li>
<li>
  <a href="https://yt4617.shinyapps.io/shiny_dashboard_template/">Get your customized restaurant</a>
</li>
<li>
  <a href="https://github.com/Tingpan2859/P8105_final_Project">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-envelope fa-lg"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mailto:yc4617@cumc.columbia.edu">Yutong Chen</a>
    </li>
    <li>
      <a href="mailto:tp2859@cumc.columbia.edu">Tingcheng Pan</a>
    </li>
    <li>
      <a href="mailto:sw3455@cumc.columbia.edu">Shiying Wu</a>
    </li>
    <li>
      <a href="mailto:yx2857@cumc.columbia.edu">Yifan Xu</a>
    </li>
  </ul>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Regional Analyze</h1>

</div>


<hr />
<div id="the-distribution-of-restaurant-frequency-by-county"
class="section level2">
<h2>The distribution of restaurant frequency by county</h2>
<p>The number of restaurant observations varies significantly across
counties in Southeastern Pennsylvania, with Philadelphia leading at
<strong>3,426</strong> and Berks having only <strong>22</strong>. This
disparity highlights potential differences in population density,
urbanization, or data representation in Yelpâ€™s dataset. Such variation
could influence future analyses, especially in identifying underserved
areas or trends in restaurant quality and accessibility between urban
and less-populated regions.</p>
<pre class="r"><code>county_counts &lt;- mergedPA |&gt;
  group_by(county) |&gt;
  summarise(count = n(), .groups = &quot;drop&quot;) |&gt;
  mutate(county = fct_reorder(county, count)) 

county_counts |&gt;
  arrange(desc(count)) |&gt;
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">county</th>
<th align="right">count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Philadelphia</td>
<td align="right">3426</td>
</tr>
<tr class="even">
<td align="left">Montgomery</td>
<td align="right">1606</td>
</tr>
<tr class="odd">
<td align="left">Bucks</td>
<td align="right">1055</td>
</tr>
<tr class="even">
<td align="left">Delaware</td>
<td align="right">995</td>
</tr>
<tr class="odd">
<td align="left">Chester</td>
<td align="right">697</td>
</tr>
<tr class="even">
<td align="left">Berks</td>
<td align="right">22</td>
</tr>
</tbody>
</table>
<pre class="r"><code>plot_ly(
  data = county_counts,
  x = ~county,
  y = ~count,
  color = ~county,
  type = &quot;bar&quot;,
  colors = &quot;viridis&quot;
) |&gt; 
  layout(
    title = &quot;Number of Entries by County&quot;,
    xaxis = list(title = &quot;County&quot;, showticklabels = TRUE),
    yaxis = list(title = &quot;Count&quot;),
    showlegend = FALSE
  )</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-35db1dbfbec445257c8b" style="width:768px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-35db1dbfbec445257c8b">{"x":{"visdat":{"cd6b4e9833df":["function () ","plotlyVisDat"]},"cur_data":"cd6b4e9833df","attrs":{"cd6b4e9833df":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Number of Entries by County","xaxis":{"domain":[0,1],"automargin":true,"title":"County","showticklabels":true,"type":"category","categoryorder":"array","categoryarray":["Berks","Chester","Delaware","Bucks","Montgomery","Philadelphia"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Count"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Berks"],"y":[22],"type":"bar","name":"Berks","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Chester"],"y":[697],"type":"bar","name":"Chester","marker":{"color":"rgba(65,68,135,1)","line":{"color":"rgba(65,68,135,1)"}},"textfont":{"color":"rgba(65,68,135,1)"},"error_y":{"color":"rgba(65,68,135,1)"},"error_x":{"color":"rgba(65,68,135,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Delaware"],"y":[995],"type":"bar","name":"Delaware","marker":{"color":"rgba(42,120,142,1)","line":{"color":"rgba(42,120,142,1)"}},"textfont":{"color":"rgba(42,120,142,1)"},"error_y":{"color":"rgba(42,120,142,1)"},"error_x":{"color":"rgba(42,120,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Bucks"],"y":[1055],"type":"bar","name":"Bucks","marker":{"color":"rgba(34,168,132,1)","line":{"color":"rgba(34,168,132,1)"}},"textfont":{"color":"rgba(34,168,132,1)"},"error_y":{"color":"rgba(34,168,132,1)"},"error_x":{"color":"rgba(34,168,132,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montgomery"],"y":[1606],"type":"bar","name":"Montgomery","marker":{"color":"rgba(122,209,81,1)","line":{"color":"rgba(122,209,81,1)"}},"textfont":{"color":"rgba(122,209,81,1)"},"error_y":{"color":"rgba(122,209,81,1)"},"error_x":{"color":"rgba(122,209,81,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Philadelphia"],"y":[3426],"type":"bar","name":"Philadelphia","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="average-star-ratings-by-county" class="section level2">
<h2>Average star ratings by county</h2>
<p>The average ratings of restaurants by county in Southeastern
Pennsylvania reveal an interesting trend. <strong>Berks</strong> County,
despite having the fewest restaurant observations, boasts the highest
average rating. This might be attributed to the limited number of
observations, as previously mentioned. In contrast, the other counties,
each with hundreds of restaurants, exhibit more stable average ratings.
Among these, <strong>Philadelphia</strong> stands out with the highest
average score, reflecting its diverse and competitive restaurant
scene.</p>
<pre class="r"><code>avg_stars &lt;- mergedPA |&gt;
  group_by(county) |&gt;
  summarise(avg_stars = mean(stars, na.rm = TRUE), .groups = &quot;drop&quot;) |&gt;
  arrange(desc(avg_stars)) |&gt; 
  mutate(county = fct_reorder(county, avg_stars))

plot_ly(
  data = avg_stars,
  x = ~county,
  y = ~avg_stars,
  color = ~county,
  type = &quot;bar&quot;,
  colors = &quot;viridis&quot;
) |&gt; 
  layout(
    title = &quot;Average Ratings by County&quot;,
    xaxis = list(title = &quot;County&quot;, showticklabels = TRUE),
    yaxis = list(title = &quot;Average Stars&quot;, range = c(3, 4)),
    showlegend = FALSE
  )</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-390d263f88d88f32e2ad" style="width:768px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-390d263f88d88f32e2ad">{"x":{"visdat":{"cd6b51a9baaa":["function () ","plotlyVisDat"]},"cur_data":"cd6b51a9baaa","attrs":{"cd6b51a9baaa":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Average Ratings by County","xaxis":{"domain":[0,1],"automargin":true,"title":"County","showticklabels":true,"type":"category","categoryorder":"array","categoryarray":["Delaware","Bucks","Montgomery","Chester","Philadelphia","Berks"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average Stars","range":[3,4]},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Delaware"],"y":[3.5271356783919594],"type":"bar","name":"Delaware","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Bucks"],"y":[3.5426540284360191],"type":"bar","name":"Bucks","marker":{"color":"rgba(65,68,135,1)","line":{"color":"rgba(65,68,135,1)"}},"textfont":{"color":"rgba(65,68,135,1)"},"error_y":{"color":"rgba(65,68,135,1)"},"error_x":{"color":"rgba(65,68,135,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montgomery"],"y":[3.5560398505603983],"type":"bar","name":"Montgomery","marker":{"color":"rgba(42,120,142,1)","line":{"color":"rgba(42,120,142,1)"}},"textfont":{"color":"rgba(42,120,142,1)"},"error_y":{"color":"rgba(42,120,142,1)"},"error_x":{"color":"rgba(42,120,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Chester"],"y":[3.5624103299856529],"type":"bar","name":"Chester","marker":{"color":"rgba(34,168,132,1)","line":{"color":"rgba(34,168,132,1)"}},"textfont":{"color":"rgba(34,168,132,1)"},"error_y":{"color":"rgba(34,168,132,1)"},"error_x":{"color":"rgba(34,168,132,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Philadelphia"],"y":[3.5881494454173972],"type":"bar","name":"Philadelphia","marker":{"color":"rgba(122,209,81,1)","line":{"color":"rgba(122,209,81,1)"}},"textfont":{"color":"rgba(122,209,81,1)"},"error_y":{"color":"rgba(122,209,81,1)"},"error_x":{"color":"rgba(122,209,81,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Berks"],"y":[3.8863636363636362],"type":"bar","name":"Berks","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="top-10-restaurant-tags-by-county" class="section level2">
<h2>Top 10 restaurant tags by county</h2>
<p>Based on Top 10 restaurant tags across counties in Southeastern
Pennsylvania, <strong>Pizza and Sandwiches</strong> dominate as the most
popular restaurant types, with Philadelphia significantly contributing
to their high counts. <strong>American (Traditional) and Breakfast &amp;
Brunch</strong> also feature prominently, reflecting common preferences
in the region. Interestingly, while counties like <strong>Philadelphia
and Montgomery</strong> contribute the most to these tags, smaller
counties like <strong>Berks</strong> have minimal representation across
all tags. This stacked visualization provides insight into both the
diversity and distribution of restaurant types across counties.</p>
<pre class="r"><code>stacked_data &lt;- mergedPA |&gt;
  separate_rows(categories, sep = &quot;,\\s*&quot;) |&gt; 
  group_by(categories, county) |&gt;
  summarise(count = n(), .groups = &quot;drop&quot;) |&gt;  
  ungroup()

top_tags &lt;- stacked_data |&gt;
  group_by(categories) |&gt;
  summarise(total_count = sum(count), .groups = &quot;drop&quot;) |&gt;
  arrange(desc(total_count)) |&gt;
  slice_max(total_count, n = 10) |&gt;
  pull(categories) 

stacked_data &lt;- stacked_data |&gt;
  filter(categories %in% top_tags) |&gt;
  mutate(categories = factor(categories, levels = top_tags))
  

plot_ly(
  data = stacked_data,
  x = ~categories,       
  y = ~count,         
  color = ~county,   
  type = &quot;bar&quot;,       
  colors = &quot;viridis&quot;
) |&gt; 
  layout(
    title = &quot;Top 10 Restaurant Tags by County&quot;,
    xaxis = list(title = &quot;Restaurant Tag&quot;, tickangle = 45), 
    yaxis = list(title = &quot;Count&quot;),
    barmode = &quot;stack&quot;
  )</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-3ff8eb734b23bcd73896" style="width:768px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-3ff8eb734b23bcd73896">{"x":{"visdat":{"cd6b2f83ed09":["function () ","plotlyVisDat"]},"cur_data":"cd6b2f83ed09","attrs":{"cd6b2f83ed09":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Top 10 Restaurant Tags by County","xaxis":{"domain":[0,1],"automargin":true,"title":"Restaurant Tag","tickangle":45,"type":"category","categoryorder":"array","categoryarray":["Pizza","Sandwiches","American (Traditional)","Breakfast & Brunch","Italian","American (New)","Burgers","Fast Food","Chinese","Seafood"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Count"},"barmode":"stack","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["American (New)","American (Traditional)","Breakfast & Brunch","Burgers","Chinese","Italian","Pizza","Sandwiches","Seafood"],"y":[3,3,4,1,2,6,7,4,2],"type":"bar","name":"Berks","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["American (New)","American (Traditional)","Breakfast & Brunch","Burgers","Chinese","Fast Food","Italian","Pizza","Sandwiches","Seafood"],"y":[118,181,130,107,78,104,156,270,218,65],"type":"bar","name":"Bucks","marker":{"color":"rgba(65,68,135,1)","line":{"color":"rgba(65,68,135,1)"}},"textfont":{"color":"rgba(65,68,135,1)"},"error_y":{"color":"rgba(65,68,135,1)"},"error_x":{"color":"rgba(65,68,135,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["American (New)","American (Traditional)","Breakfast & Brunch","Burgers","Chinese","Fast Food","Italian","Pizza","Sandwiches","Seafood"],"y":[87,119,86,65,45,70,96,144,135,39],"type":"bar","name":"Chester","marker":{"color":"rgba(42,120,142,1)","line":{"color":"rgba(42,120,142,1)"}},"textfont":{"color":"rgba(42,120,142,1)"},"error_y":{"color":"rgba(42,120,142,1)"},"error_x":{"color":"rgba(42,120,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["American (New)","American (Traditional)","Breakfast & Brunch","Burgers","Chinese","Fast Food","Italian","Pizza","Sandwiches","Seafood"],"y":[89,177,117,103,80,93,129,230,234,70],"type":"bar","name":"Delaware","marker":{"color":"rgba(34,168,132,1)","line":{"color":"rgba(34,168,132,1)"}},"textfont":{"color":"rgba(34,168,132,1)"},"error_y":{"color":"rgba(34,168,132,1)"},"error_x":{"color":"rgba(34,168,132,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["American (New)","American (Traditional)","Breakfast & Brunch","Burgers","Chinese","Fast Food","Italian","Pizza","Sandwiches","Seafood"],"y":[171,282,174,174,123,164,241,320,303,105],"type":"bar","name":"Montgomery","marker":{"color":"rgba(122,209,81,1)","line":{"color":"rgba(122,209,81,1)"}},"textfont":{"color":"rgba(122,209,81,1)"},"error_y":{"color":"rgba(122,209,81,1)"},"error_x":{"color":"rgba(122,209,81,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["American (New)","American (Traditional)","Breakfast & Brunch","Burgers","Chinese","Fast Food","Italian","Pizza","Sandwiches","Seafood"],"y":[374,434,416,250,301,260,281,532,580,240],"type":"bar","name":"Philadelphia","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="price-range-by-county" class="section level2">
<h2>Price range by County</h2>
<p>The price range was calculated as the difference between the minimum
and maximum prices for restaurants in each county, with a standardized
cap of 200 units applied due to the absence of explicit maximum price
data. The results show that counties like <strong>Philadelphia and
Montgomery</strong> have the widest price ranges, reflecting diverse
dining options, while <strong>Berks</strong> has the smallest range,
indicating less variation in pricing.</p>
<pre class="r"><code>library(jsonlite)
clean_and_format_parking &lt;- function(parking) {
  if (is.na(parking)) return(&quot;No parking info available&quot;)

  parking &lt;- gsub(&quot;&#39;&quot;, &quot;\&quot;&quot;, parking)
  
  parking &lt;- gsub(&quot;u\&quot;&quot;, &quot;\&quot;&quot;, parking)
  
  parking &lt;- gsub(&quot;False&quot;, &quot;false&quot;, gsub(&quot;True&quot;, &quot;true&quot;, gsub(&quot;None&quot;, &quot;null&quot;, parking)))

  parking_list &lt;- tryCatch(fromJSON(parking), error = function(e) {
    message(&quot;Parsing error:&quot;, e$message)
    return(NULL)
  })

  if (is.null(parking_list)) return(&quot;Invalid parking data&quot;)

  readable &lt;- paste0(
    names(parking_list), &quot;: &quot;, ifelse(unlist(parking_list), &quot;Yes&quot;, &quot;No&quot;), collapse = &quot;, &quot;
  )
  
  return(readable)
}

clean &lt;- function(attire) {
  if (is.na(attire)) return(NA) # Handle NA values
  attire &lt;- gsub(&quot;u&#39;&quot;, &quot;&quot;, attire) # Remove the u&#39; prefix
  attire &lt;- gsub(&quot;&#39;&quot;, &quot;&quot;, attire) # Remove single quotes
  return(attire)
}


filterPA = filterPA |&gt; 
  left_join(county, by = &quot;city&quot;)|&gt;
  unnest_wider(attributes)|&gt;
  unnest_wider(hours)|&gt;
  mutate(RestaurantsPriceRange2 = 
           case_match(RestaurantsPriceRange2,
                      &quot;1&quot; ~ &quot;0-10&quot;,
                      &quot;2&quot; ~ &quot;11-30&quot;,
                      &quot;3&quot; ~ &quot;31-60&quot;,
                      &quot;4&quot; ~ &quot;61-200&quot;))|&gt;
  pivot_longer(
    cols = Monday:Sunday,
    names_to = &quot;day&quot;,
    values_to = &quot;hour&quot;
  )|&gt;
  filter(!is.na(hour))|&gt;  
  separate(hour, into = c(&quot;start_time&quot;, &quot;end_time&quot;), sep = &quot;-&quot;)|&gt;
  mutate(
    start_time = as.numeric(substr(start_time, 1, 2)) + as.numeric(substr(start_time, 4, 5)) / 60,
    end_time = as.numeric(substr(end_time, 1, 2)) + as.numeric(substr(end_time, 4, 5)) / 60
  )|&gt;
  separate(categories, into = c(&quot;categories&quot;, &quot;other_categories&quot;), sep = &quot;,&quot;, extra = &quot;drop&quot;)|&gt;
  mutate(WiFi = gsub(&quot;.*&#39;(.*?)&#39;.*&quot;, &quot;\\1&quot;, WiFi),
         BusinessParking = sapply(BusinessParking,clean_and_format_parking),
         across(everything(), ~ ifelse(is.na(.), &quot;No info&quot;, .)),
         NoiseLevel = sapply(NoiseLevel,clean),
         RestaurantsAttire = sapply(RestaurantsAttire,clean),
         Alcohol = sapply(Alcohol,clean),
         name = gsub(&quot;^[^a-zA-Z0-9]+&quot;, &quot;&quot;, name)
  )

plot_data &lt;- filterPA |&gt;
  filter(RestaurantsPriceRange2 != &quot;No info&quot;) |&gt;  # Exclude &quot;No info&quot;
  filter(county != &quot;No info&quot;) |&gt;  # Exclude &quot;No info&quot;
  separate(RestaurantsPriceRange2, into = c(&quot;min_price&quot;, &quot;max_price&quot;), sep = &quot;-&quot;) |&gt;
  group_by(county) |&gt;
  summarize(
    max_price = max(as.numeric(max_price), na.rm = TRUE),
    min_price = min(as.numeric(min_price), na.rm = TRUE),
    price_range = max_price - min_price
  ) |&gt;
  arrange(desc(price_range))

# Create a plotly bar chart
plot_ly(
  data = plot_data,
  x = ~reorder(county, price_range),
  y = ~price_range,
  type = &#39;bar&#39;,
  color = ~county,
  colors = &quot;viridis&quot;
) |&gt;
  layout(
    title = &quot;Price Range by County&quot;,
    xaxis = list(
      title = &quot;County&quot;
    ),
    yaxis = list(
      title = &quot;Price Range&quot;
    ),
    showlegend = FALSE
  )</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-6aae02e163cd41908495" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-6aae02e163cd41908495">{"x":{"visdat":{"cd6b5f6c192e":["function () ","plotlyVisDat"]},"cur_data":"cd6b5f6c192e","attrs":{"cd6b5f6c192e":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Price Range by County","xaxis":{"domain":[0,1],"automargin":true,"title":"County","type":"category","categoryorder":"array","categoryarray":["Berks","Bucks","Chester","Delaware","Montgomery","Philadelphia"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Price Range"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Berks"],"y":[60],"type":"bar","name":"Berks","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"textfont":{"color":"rgba(68,1,84,1)"},"error_y":{"color":"rgba(68,1,84,1)"},"error_x":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Bucks"],"y":[200],"type":"bar","name":"Bucks","marker":{"color":"rgba(65,68,135,1)","line":{"color":"rgba(65,68,135,1)"}},"textfont":{"color":"rgba(65,68,135,1)"},"error_y":{"color":"rgba(65,68,135,1)"},"error_x":{"color":"rgba(65,68,135,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Chester"],"y":[200],"type":"bar","name":"Chester","marker":{"color":"rgba(42,120,142,1)","line":{"color":"rgba(42,120,142,1)"}},"textfont":{"color":"rgba(42,120,142,1)"},"error_y":{"color":"rgba(42,120,142,1)"},"error_x":{"color":"rgba(42,120,142,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Delaware"],"y":[200],"type":"bar","name":"Delaware","marker":{"color":"rgba(34,168,132,1)","line":{"color":"rgba(34,168,132,1)"}},"textfont":{"color":"rgba(34,168,132,1)"},"error_y":{"color":"rgba(34,168,132,1)"},"error_x":{"color":"rgba(34,168,132,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Montgomery"],"y":[200],"type":"bar","name":"Montgomery","marker":{"color":"rgba(122,209,81,1)","line":{"color":"rgba(122,209,81,1)"}},"textfont":{"color":"rgba(122,209,81,1)"},"error_y":{"color":"rgba(122,209,81,1)"},"error_x":{"color":"rgba(122,209,81,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Philadelphia"],"y":[200],"type":"bar","name":"Philadelphia","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"textfont":{"color":"rgba(253,231,37,1)"},"error_y":{"color":"rgba(253,231,37,1)"},"error_x":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
